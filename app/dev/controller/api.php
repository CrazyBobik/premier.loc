<?phpdefined('K_PATH') or die('DIRECT ACCESS IS NOT ALLOWED');class Dev_Controller_Api extends Controller {    /* {public} */    public $layout = 'layout';    public function onInit() {        $this->treeTable = new K_Tree_Model();    }    /* {actions} */    public function uploadImageAction() {        $returnJson = array();        $form = new K_Form();        $uploadDir = WWW_PATH . '/upload';        if ($form->hasFiles()) {            $files = $form->getFiles();            if ($files['file'] && explode('/' . $files['file']["type"])[0] = 'image') {                preg_match('/^.*\.(jpg|png|jpeg|gif|bmp)$/im', $elementData);                $pathData = $form->moveUploadedFile('file', $uploadDir, md5(time() . rand()), true);                $returnJson['filelink'] = '/upload/' . $pathData['filename'];            }        }        $this->putJSON($returnJson);    }}